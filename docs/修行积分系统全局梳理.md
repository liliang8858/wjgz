# ðŸ§˜â€â™‚ï¸ ä¿®è¡Œç§¯åˆ†ç³»ç»Ÿå…¨å±€æ¢³ç†

## ðŸ“Š ç³»ç»Ÿæž¶æž„æ¦‚è§ˆ

### åŒé‡ç§¯åˆ†ä½“ç³»

æ¸¸æˆé‡‡ç”¨**åŒé‡ç§¯åˆ†ä½“ç³»**ï¼ŒåŒ…å«ä¸¤ä¸ªä¸åŒå±‚æ¬¡çš„ç§¯åˆ†æ¦‚å¿µï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¿®è¡Œç§¯åˆ†ç³»ç»Ÿæž¶æž„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    è½¬æ¢    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   å…³å¡ç§¯åˆ†      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   ä¿®è¡Œç§¯åˆ†      â”‚         â”‚
â”‚  â”‚  (ä¸´æ—¶/å½“å‰)    â”‚             â”‚  (æ°¸ä¹…/ç´¯ç§¯)    â”‚         â”‚
â”‚  â”‚                 â”‚             â”‚                 â”‚         â”‚
â”‚  â”‚ â€¢ score: Int    â”‚             â”‚ â€¢ cultivation   â”‚         â”‚
â”‚  â”‚ â€¢ å½“å‰å…³å¡å¾—åˆ†  â”‚             â”‚ â€¢ è·¨å…³å¡ä¿å­˜    â”‚         â”‚
â”‚  â”‚ â€¢ é‡æ–°å¼€å§‹æ¸…é›¶  â”‚             â”‚ â€¢ ä¿®ä¸ºå¢ƒç•ŒåŸºç¡€  â”‚         â”‚
â”‚  â”‚ â€¢ å®žæ—¶å˜åŒ–      â”‚             â”‚ â€¢ æˆé•¿è¿›åº¦ä½“çŽ°  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                               â”‚                 â”‚
â”‚           â–¼                               â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   UIæ˜¾ç¤ºé€»è¾‘    â”‚             â”‚   å¢ƒç•Œç³»ç»Ÿ      â”‚         â”‚
â”‚  â”‚                 â”‚             â”‚                 â”‚         â”‚
â”‚  â”‚ æ˜¾ç¤º: cultivationâ”‚             â”‚ â€¢ ç»ƒæ°”æœŸ (0-99) â”‚         â”‚
â”‚  â”‚      + score     â”‚             â”‚ â€¢ ç­‘åŸºæœŸ(100-299)â”‚        â”‚
â”‚  â”‚                 â”‚             â”‚ â€¢ é‡‘ä¸¹æœŸ(300-599)â”‚        â”‚
â”‚  â”‚ å®žæ—¶åé¦ˆæ€»ä¿®ä¸º  â”‚             â”‚ â€¢ å…ƒå©´æœŸ(600-999)â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸŽ¯ ç§¯åˆ†ç±»åž‹è¯¦è§£

### 1. å…³å¡ç§¯åˆ† (score)

**å®šä¹‰**: å½“å‰å…³å¡ä¸­èŽ·å¾—çš„ä¸´æ—¶åˆ†æ•°
- **ç±»åž‹**: `Int`
- **ä½œç”¨åŸŸ**: å•ä¸ªå…³å¡å†…
- **ç”Ÿå‘½å‘¨æœŸ**: å…³å¡å¼€å§‹æ—¶ä¸º0ï¼Œå…³å¡ç»“æŸæ—¶å‚ä¸Žä¿®ä¸ºè®¡ç®—åŽé‡ç½®

**èŽ·å¾—æ–¹å¼**:
```swift
// åˆæˆèŽ·å¾—ç§¯åˆ†
addScore(points)  // åŸºç¡€åˆ†æ•° * è¿žå‡»å€æ•°

// æ¶ˆé™¤èŽ·å¾—ç§¯åˆ†  
addScore(5)       // æ¯ä¸ªæ¶ˆé™¤çš„å‰‘ +5åˆ†

// ç‰¹æ®Šå¥–åŠ±
addScore(1000)    // ç¥žå‰‘åˆæˆå¥–åŠ±
addScore(50)      // ç¥žå‰‘å‘¨å›´æ¸…é™¤å¥–åŠ±
```

**é‡ç½®æ—¶æœº**:
- `restartGame()`: é‡æ–°å¼€å§‹å½“å‰å…³å¡
- `goToNextLevel()`: è¿›å…¥ä¸‹ä¸€å…³å¡
- å…³å¡å¤±è´¥é‡è¯•

### 2. ä¿®è¡Œç§¯åˆ† (cultivation)

**å®šä¹‰**: è·¨å…³å¡ç´¯ç§¯çš„æ°¸ä¹…ä¿®ä¸ºå€¼
- **ç±»åž‹**: `Int`
- **ä½œç”¨åŸŸ**: å…¨å±€æ¸¸æˆè¿›åº¦
- **ç”Ÿå‘½å‘¨æœŸ**: æ°¸ä¹…ä¿å­˜ï¼Œåªå¢žä¸å‡

**è®¡ç®—å…¬å¼**:
```swift
private func calculateCultivationGain(levelId: Int, stars: Int, score: Int) -> Int {
    let baseGain = levelId * 10      // åŸºç¡€ä¿®ä¸º = å…³å¡ID Ã— 10
    let starBonus = stars * 5        // æ˜Ÿçº§å¥–åŠ± = æ˜Ÿæ•° Ã— 5  
    let scoreBonus = score / 100     // åˆ†æ•°å¥–åŠ± = å…³å¡åˆ†æ•° Ã· 100
    return baseGain + starBonus + scoreBonus
}
```

**èŽ·å¾—æ—¶æœº**:
- å…³å¡å®Œæˆæ—¶è°ƒç”¨`GameStateManager.shared.completeLevel()`
- è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
- å¤±è´¥æ—¶ä¿æŒä¸å˜

## ðŸ”„ ç§¯åˆ†æµè½¬é€»è¾‘

### æ¸¸æˆè¿›è¡Œä¸­
```
ç”¨æˆ·æ“ä½œ â†’ èŽ·å¾—å…³å¡ç§¯åˆ†(score) â†’ UIæ˜¾ç¤º(cultivation + score)
```

### å…³å¡å®Œæˆæ—¶
```
å…³å¡ç§¯åˆ†(score) â†’ è®¡ç®—ä¿®ä¸ºå¢žé•¿ â†’ ç´¯åŠ åˆ°ä¿®è¡Œç§¯åˆ†(cultivation) â†’ ä¿å­˜ â†’ é‡ç½®å…³å¡ç§¯åˆ†(score=0)
```

### å…³å¡å¤±è´¥æ—¶
```
å…³å¡ç§¯åˆ†(score) â†’ ä¸¢å¼ƒ â†’ ä¿®è¡Œç§¯åˆ†(cultivation)ä¿æŒä¸å˜ â†’ é‡ç½®å…³å¡ç§¯åˆ†(score=0)
```

## ðŸ–¥ï¸ UIæ˜¾ç¤ºç­–ç•¥

### å½“å‰å®žçŽ°
```swift
private func updateUI() {
    let totalCultivation = GameStateManager.shared.cultivation + score
    scoreLabel.text = "\(totalCultivation)"
}
```

**æ˜¾ç¤ºé€»è¾‘**:
- **æ¸¸æˆè¿›è¡Œä¸­**: æ˜¾ç¤º `å·²ä¿å­˜ä¿®ä¸º + å½“å‰å…³å¡å¾—åˆ†`
- **å…³å¡å®ŒæˆåŽ**: æ˜¾ç¤º `æ–°çš„ç´¯ç§¯ä¿®ä¸º`
- **é‡æ–°å¼€å§‹**: æ˜¾ç¤º `å·²ä¿å­˜ä¿®ä¸º`

### ä¼˜åŒ–å»ºè®®

ä¸ºäº†æ›´æ¸…æ™°åœ°åŒºåˆ†ä¸¤ç§ç§¯åˆ†ï¼Œå»ºè®®æ”¹è¿›UIæ˜¾ç¤ºï¼š

```swift
// å»ºè®®çš„UIæ˜¾ç¤ºé€»è¾‘
private func updateUI() {
    // ä¸»æ˜¾ç¤ºï¼šæ€»ä¿®ä¸ºï¼ˆå·²ä¿å­˜ + å½“å‰ï¼‰
    let totalCultivation = GameStateManager.shared.cultivation + score
    scoreLabel.text = "\(totalCultivation)"
    
    // å¯é€‰ï¼šæ·»åŠ å½“å‰å…³å¡åˆ†æ•°çš„å°å­—æ˜¾ç¤º
    if score > 0 {
        // æ˜¾ç¤ºå½“å‰å…³å¡è´¡çŒ®çš„åˆ†æ•°
        currentScoreLabel?.text = "+\(score)"
        currentScoreLabel?.isHidden = false
    } else {
        currentScoreLabel?.isHidden = true
    }
}
```

## ðŸ† å¢ƒç•Œç³»ç»Ÿæ˜ å°„

```swift
func getCultivationTitle() -> String {
    switch cultivation {
    case 0..<100:     return "ç»ƒæ°”æœŸ"      // 0-99ä¿®ä¸º
    case 100..<300:   return "ç­‘åŸºæœŸ"      // 100-299ä¿®ä¸º  
    case 300..<600:   return "é‡‘ä¸¹æœŸ"      // 300-599ä¿®ä¸º
    case 600..<1000:  return "å…ƒå©´æœŸ"      // 600-999ä¿®ä¸º
    case 1000..<1500: return "åŒ–ç¥žæœŸ"      // 1000-1499ä¿®ä¸º
    case 1500..<2100: return "ç‚¼è™šæœŸ"      // 1500-2099ä¿®ä¸º
    case 2100..<2800: return "åˆä½“æœŸ"      // 2100-2799ä¿®ä¸º
    case 2800..<3600: return "å¤§ä¹˜æœŸ"      // 2800-3599ä¿®ä¸º
    case 3600..<4500: return "æ¸¡åŠ«æœŸ"      // 3600-4499ä¿®ä¸º
    default:          return "é£žå‡ä»™äºº"    // 4500+ä¿®ä¸º
    }
}
```

## ðŸ“ˆ ç§¯åˆ†èŽ·å¾—ç¤ºä¾‹

### ç¤ºä¾‹ï¼šå®Œæˆç¬¬5å…³
```
å…³å¡è¿›è¡Œä¸­:
- åˆæˆèŽ·å¾—: 200åˆ†
- æ¶ˆé™¤èŽ·å¾—: 50åˆ†  
- ç‰¹æ®Šå¥–åŠ±: 100åˆ†
- å…³å¡æ€»åˆ†: 350åˆ†
- UIæ˜¾ç¤º: å·²ä¿å­˜ä¿®ä¸º(500) + å½“å‰å¾—åˆ†(350) = 850

å…³å¡å®Œæˆæ—¶:
- åŸºç¡€ä¿®ä¸º: 5 Ã— 10 = 50
- æ˜Ÿçº§å¥–åŠ±: 3 Ã— 5 = 15 (å‡è®¾3æ˜Ÿ)
- åˆ†æ•°å¥–åŠ±: 350 Ã· 100 = 3
- ä¿®ä¸ºå¢žé•¿: 50 + 15 + 3 = 68
- æ–°æ€»ä¿®ä¸º: 500 + 68 = 568
- å¢ƒç•Œ: é‡‘ä¸¹æœŸ (300-599)

è¿›å…¥ç¬¬6å…³:
- å…³å¡ç§¯åˆ†: 0 (é‡ç½®)
- ä¿®è¡Œç§¯åˆ†: 568 (ä¿å­˜)
- UIæ˜¾ç¤º: 568
```

## ðŸ”§ ç³»ç»Ÿä¼˜åŒ–å»ºè®®

### 1. UIæ˜¾ç¤ºä¼˜åŒ–
- ä¸»æ˜¾ç¤ºï¼šæ€»ä¿®ä¸ºï¼ˆå¤§å­—ï¼‰
- å‰¯æ˜¾ç¤ºï¼šå½“å‰å…³å¡è´¡çŒ®ï¼ˆå°å­—ï¼Œ+Xæ ¼å¼ï¼‰
- å¢ƒç•Œæ˜¾ç¤ºï¼šä¿®ä¸ºç§°å·

### 2. åé¦ˆæœºåˆ¶ä¼˜åŒ–
- å…³å¡å®Œæˆæ—¶æ˜¾ç¤ºä¿®ä¸ºå¢žé•¿åŠ¨ç”»
- å¢ƒç•Œæå‡æ—¶ç‰¹æ®Šåº†ç¥æ•ˆæžœ
- ä¿®ä¸ºé‡Œç¨‹ç¢‘æˆå°±ç³»ç»Ÿ

### 3. æ•°æ®æŒä¹…åŒ–
- ä¿®è¡Œç§¯åˆ†è‡ªåŠ¨ä¿å­˜ âœ…
- å…³å¡ç§¯åˆ†ä¸´æ—¶å­˜å‚¨ âœ…
- å¢ƒç•ŒåŽ†å²è®°å½•ï¼ˆå¯é€‰ï¼‰

## ðŸ“ æ€»ç»“

**ä¿®è¡Œç§¯åˆ†ç³»ç»Ÿ**é‡‡ç”¨åŒé‡ç§¯åˆ†è®¾è®¡ï¼š
- **å…³å¡ç§¯åˆ†**ï¼šä¸´æ—¶ã€å¯å˜ã€ç”¨äºŽå®žæ—¶åé¦ˆ
- **ä¿®è¡Œç§¯åˆ†**ï¼šæ°¸ä¹…ã€ç´¯ç§¯ã€ç”¨äºŽé•¿æœŸè¿›åº¦

è¿™ç§è®¾è®¡æ—¢ä¿è¯äº†æ¸¸æˆå†…çš„å³æ—¶åé¦ˆï¼Œåˆæä¾›äº†è·¨å…³å¡çš„æˆé•¿æ„Ÿï¼Œæ˜¯ä¸€ä¸ªå®Œæ•´ä¸”åˆç†çš„ç§¯åˆ†ä½“ç³»ã€‚

å½“å‰å®žçŽ°åŸºæœ¬æ­£ç¡®ï¼ŒUIæ˜¾ç¤ºé€»è¾‘æ¸…æ™°ï¼Œç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°æŒç»­å¢žé•¿çš„ä¿®ä¸ºç§¯åˆ†ï¼Œæœ‰æ•ˆè§£å†³äº†ä¹‹å‰"ç§¯åˆ†æ¸…é›¶"çš„ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚