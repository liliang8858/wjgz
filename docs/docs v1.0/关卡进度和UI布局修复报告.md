# å…³å¡è¿›åº¦å’ŒUIå¸ƒå±€ä¿®å¤æŠ¥å‘Š

## ä¿®å¤æ¦‚è¿°
æ ¹æ®ç”¨æˆ·åé¦ˆï¼Œè§£å†³äº†4ä¸ªå…³é”®çš„UIå’ŒåŠŸèƒ½é—®é¢˜ï¼š

1. âœ… ä¿®å¤ç¬¬ä¸€å…³å®Œæˆåæ— æ³•è¿›å…¥ä¸‹ä¸€å…³çš„é—®é¢˜
2. âœ… å³ä¸‹è§’"é˜µ"æ¨¡å—å‘ä¸‹æŒªåŠ¨ï¼Œé¿å…è¢«å‰‘æ„æ¡é®æŒ¡
3. âœ… å·¦ä¸‹è§’"ä¿®"æ¨¡å—å’Œå³ä¸‹è§’"é˜µ"æ¨¡å—é«˜åº¦ä¿æŒä¸€è‡´
4. âœ… "ä¿®"æ¨¡å—å’Œ"é˜µ"æ¨¡å—å®½åº¦æ”¾å®½ï¼Œæå‡è§†è§‰æ•ˆæœ

## è¯¦ç»†ä¿®å¤å†…å®¹

### 1. å…³å¡è¿›åº¦é—®é¢˜ä¿®å¤

#### ğŸ› é—®é¢˜åˆ†æ
**æ ¹æœ¬åŸå› **: åœ¨å…³å¡å®Œæˆé€»è¾‘ä¸­å­˜åœ¨çŠ¶æ€ç®¡ç†æ··ä¹±
- `completeLevel()` å‡½æ•°ä¼šæ›´æ–° `GameStateManager.currentLevel` ä¸ºä¸‹ä¸€å…³
- ä½†åœ¨æ˜¾ç¤ºå…³å¡å®ŒæˆUIæ—¶ï¼Œä»ä½¿ç”¨æ—§çš„ `currentLevel` å¯¹è±¡è¿›è¡Œåˆ¤æ–­
- å¯¼è‡´ `hasNextLevel` åˆ¤æ–­é€»è¾‘é”™è¯¯

**å…·ä½“é—®é¢˜æµç¨‹**:
1. ç¬¬1å…³å®Œæˆ â†’ `completeLevel(1)` è¢«è°ƒç”¨
2. `GameStateManager.currentLevel` è¢«è®¾ç½®ä¸º 2
3. ä½† `showLevelCompleteUI` ä¸­ä»ä½¿ç”¨åœºæ™¯ä¸­çš„ `currentLevel` (ä»ä¸ºç¬¬1å…³)
4. åˆ¤æ–­ `currentLevel.id + 1` (1+1=2) æ—¶å‡ºç°é€»è¾‘é”™è¯¯

#### âœ… è§£å†³æ–¹æ¡ˆ
**åˆ†ç¦»å…³å¡IDç®¡ç†**:
```swift
// ä¿®å¤å‰ - æœ‰é—®é¢˜çš„é€»è¾‘
private func triggerLevelComplete() {
    let stars = currentLevel.calculateStars(score: score)
    GameStateManager.shared.completeLevel(currentLevel.id, stars: stars, score: score)
    // currentLevelå¯¹è±¡çŠ¶æ€å¯èƒ½ä¸ä¸€è‡´
    showLevelCompleteUI(stars: stars)
}

// ä¿®å¤å - æ¸…æ™°çš„çŠ¶æ€ç®¡ç†
private func triggerLevelComplete() {
    let stars = currentLevel.calculateStars(score: score)
    let completedLevelId = currentLevel.id  // ä¿å­˜å®Œæˆçš„å…³å¡ID
    GameStateManager.shared.completeLevel(completedLevelId, stars: stars, score: score)
    showLevelCompleteUI(stars: stars, completedLevelId: completedLevelId)
}
```

**æ”¹è¿›åˆ¤æ–­é€»è¾‘**:
```swift
// ä½¿ç”¨æ˜ç¡®çš„å®Œæˆå…³å¡IDè¿›è¡Œåˆ¤æ–­
let nextLevelId = completedLevelId + 1
let hasNextLevel = nextLevelId <= LevelConfig.shared.levels.count
```

**å¢å¼ºè°ƒè¯•ä¿¡æ¯**:
- æ‰“å°å®Œæˆçš„å…³å¡ID
- æ‰“å°ä¸‹ä¸€å…³IDå’Œæ€»å…³å¡æ•°
- æ‰“å°GameStateManagerçš„å½“å‰çŠ¶æ€
- ä¾¿äºæ’æŸ¥å’ŒéªŒè¯ä¿®å¤æ•ˆæœ

### 2. UIå¸ƒå±€ä¼˜åŒ–

#### ğŸ¨ é¢æ¿ä½ç½®å’Œå°ºå¯¸è°ƒæ•´

**å·¦ä¸‹è§’"ä¿®"æ¨¡å—ä¼˜åŒ–**:
- **å®½åº¦**: 120px â†’ 140px (+20px)
- **ä½ç½®**: å‘ä¸‹ç§»åŠ¨20pxï¼Œé¿å…ä¸èƒ½é‡æ¡é‡å 
- **å›¾æ ‡ä½ç½®**: é€‚åº”æ–°å®½åº¦è°ƒæ•´ (-40px â†’ -50px)

**å³ä¸‹è§’"é˜µ"æ¨¡å—ä¼˜åŒ–**:
- **å®½åº¦**: 120px â†’ 140px (+20px) 
- **é«˜åº¦**: ä¿æŒ90px (å®¹çº³ç»ˆæå¥¥ä¹‰ä¿¡æ¯)
- **ä½ç½®**: å‘ä¸‹ç§»åŠ¨20pxï¼Œé¿å…è¢«å‰‘æ„æ¡é®æŒ¡
- **å›¾æ ‡ä½ç½®**: é€‚åº”æ–°å®½åº¦è°ƒæ•´ (-40px â†’ -50px)

**èƒ½é‡æ¡ä½ç½®è°ƒæ•´**:
- **ä½ç½®**: å‘ä¸Šç§»åŠ¨20px (185px â†’ 165px)
- **ç›®çš„**: ä¸ºä¸‹æ–¹é¢æ¿è…¾å‡ºç©ºé—´ï¼Œé¿å…é‡å 

#### ğŸ“ å¸ƒå±€åæ ‡å¯¹æ¯”

| å…ƒç´  | ä¿®å¤å‰ä½ç½® | ä¿®å¤åä½ç½® | å˜åŒ– |
|------|-----------|-----------|------|
| ä¿®æ¨¡å— | (-75, 130) | (-85, 110) | ä¸‹ç§»20px, å·¦ç§»10px |
| é˜µæ¨¡å— | (-75, 145) | (-85, 125) | ä¸‹ç§»20px, å·¦ç§»10px |
| èƒ½é‡æ¡ | (20, 185) | (20, 165) | ä¸Šç§»20px |

### 3. è§†è§‰æ•ˆæœæå‡

#### ğŸ¯ ç©ºé—´åˆ©ç”¨ä¼˜åŒ–
- **æ›´å®½çš„é¢æ¿**: æä¾›æ›´å¤šç©ºé—´æ˜¾ç¤ºä¿¡æ¯
- **åˆç†çš„é—´è·**: é¿å…UIå…ƒç´ é‡å å’Œé®æŒ¡
- **å¯¹ç§°çš„å¸ƒå±€**: å·¦å³é¢æ¿å°ºå¯¸ä¸€è‡´ï¼Œè§†è§‰å¹³è¡¡

#### ğŸ¨ ç”¨æˆ·ä½“éªŒæ”¹å–„
- **ä¿¡æ¯å¯è¯»æ€§**: æ›´å®½çš„é¢æ¿è®©æ–‡å­—å’Œæ•°å­—æ˜¾ç¤ºæ›´æ¸…æ™°
- **è§†è§‰å±‚æ¬¡**: æ¸…æ™°çš„å…ƒç´ åˆ†å±‚ï¼Œé¿å…æ··ä¹±
- **æ“ä½œä¾¿åˆ©æ€§**: é¢æ¿ä¸è¢«å…¶ä»–å…ƒç´ é®æŒ¡ï¼Œä¾¿äºæŸ¥çœ‹

## æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. çŠ¶æ€ç®¡ç†æ”¹è¿›
```swift
// æ–°å¢å‚æ•°ä¼ é€’å®Œæˆçš„å…³å¡ID
private func showLevelCompleteUI(stars: Int, completedLevelId: Int) {
    let nextLevelId = completedLevelId + 1
    let hasNextLevel = nextLevelId <= LevelConfig.shared.levels.count
    // ä½¿ç”¨æ˜ç¡®çš„IDè¿›è¡Œåˆ¤æ–­ï¼Œé¿å…çŠ¶æ€æ··ä¹±
}
```

### 2. UIåæ ‡ç³»ç»Ÿ
```swift
// ç»Ÿä¸€çš„é¢æ¿å°ºå¯¸
let panelSize = CGSize(width: 140, height: 60/90)  // ä¿®/é˜µæ¨¡å—

// è®¡ç®—çš„ä½ç½®åç§»
let baseY = -size.height/2 + 110  // åŸºå‡†Yåæ ‡
let leftX = -size.width/2 + 85    // å·¦é¢æ¿Xåæ ‡  
let rightX = size.width/2 - 85    // å³é¢æ¿Xåæ ‡
```

### 3. å“åº”å¼å¸ƒå±€
- é¢æ¿ä½ç½®åŸºäºå±å¹•å°ºå¯¸è®¡ç®—
- å›¾æ ‡å’Œæ–‡å­—ä½ç½®ç›¸å¯¹äºé¢æ¿ä¸­å¿ƒå®šä½
- æ”¯æŒä¸åŒå±å¹•å°ºå¯¸çš„é€‚é…

## æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•
- âœ… ç¬¬ä¸€å…³å®Œæˆå"ä¸‹ä¸€å…³"æŒ‰é’®æ­£å¸¸æ˜¾ç¤º
- âœ… ç‚¹å‡»"ä¸‹ä¸€å…³"æŒ‰é’®å¯ä»¥æ­£å¸¸è¿›å…¥ç¬¬äºŒå…³
- âœ… å…³å¡è¿›åº¦çŠ¶æ€æ­£ç¡®ä¿å­˜å’ŒåŠ è½½

### è§†è§‰æµ‹è¯•  
- âœ… å·¦å³é¢æ¿é«˜åº¦ä¸€è‡´ï¼Œè§†è§‰å¹³è¡¡
- âœ… é¢æ¿å®½åº¦å¢åŠ ï¼Œä¿¡æ¯æ˜¾ç¤ºæ›´æ¸…æ™°
- âœ… å³ä¸‹è§’é¢æ¿ä¸è¢«å‰‘æ„æ¡é®æŒ¡
- âœ… æ‰€æœ‰UIå…ƒç´ æ— é‡å ï¼Œå±‚æ¬¡æ¸…æ™°

### å…¼å®¹æ€§æµ‹è¯•
- âœ… ä¸åŒå…³å¡çš„UIæ˜¾ç¤ºæ­£å¸¸
- âœ… ç»ˆæå¥¥ä¹‰ä¿¡æ¯åœ¨é¢æ¿ä¸­æ­£ç¡®æ˜¾ç¤º
- âœ… èƒ½é‡æ¡å’Œé¢æ¿ä½ç½®åè°ƒ

## è°ƒè¯•ä¿¡æ¯å¢å¼º

### å…³å¡è¿›åº¦è°ƒè¯•
```
ğŸ” å…³å¡å®Œæˆæ£€æŸ¥: å®Œæˆå…³å¡=1, ä¸‹ä¸€å…³=2, æ€»å…³å¡æ•°=24, æœ‰ä¸‹ä¸€å…³=true
ğŸ” å·²è§£é”å…³å¡: [1, 2]
ğŸ” å½“å‰GameStateManager.currentLevel: 2
```

### çŠ¶æ€éªŒè¯
- å®Œæˆå…³å¡IDæ˜ç¡®è®°å½•
- ä¸‹ä¸€å…³è§£é”çŠ¶æ€å¯è¿½è¸ª
- GameStateManagerçŠ¶æ€å˜åŒ–å¯è§‚å¯Ÿ

## ä»£ç è´¨é‡æ”¹è¿›

### 1. æ¸…æ™°çš„å‚æ•°ä¼ é€’
- é¿å…éšå¼çŠ¶æ€ä¾èµ–
- æ˜ç¡®çš„å‡½æ•°ç­¾åå’Œå‚æ•°
- å‡å°‘çŠ¶æ€ç®¡ç†çš„å¤æ‚æ€§

### 2. ä¸€è‡´çš„å‘½åè§„èŒƒ
- `completedLevelId` æ˜ç¡®è¡¨ç¤ºå·²å®Œæˆçš„å…³å¡
- `nextLevelId` æ˜ç¡®è¡¨ç¤ºä¸‹ä¸€å…³å¡
- é¿å…æ­§ä¹‰å’Œæ··æ·†

### 3. æ¨¡å—åŒ–çš„UIç®¡ç†
- é¢æ¿åˆ›å»ºé€»è¾‘é›†ä¸­ç®¡ç†
- åæ ‡è®¡ç®—ç»Ÿä¸€å¤„ç†
- ä¾¿äºç»´æŠ¤å’Œè°ƒæ•´

## ç”¨æˆ·ä½“éªŒæå‡

### 1. æ¸¸æˆæµç¨‹é¡ºç•…
- **å…³å¡æ¨è¿›æ­£å¸¸**: ç¬¬ä¸€å…³å®Œæˆåå¯ä»¥é¡ºåˆ©è¿›å…¥ä¸‹ä¸€å…³
- **çŠ¶æ€ä¿å­˜å¯é **: æ¸¸æˆè¿›åº¦æ­£ç¡®ä¿å­˜ï¼Œä¸ä¼šä¸¢å¤±
- **åé¦ˆåŠæ—¶**: è°ƒè¯•ä¿¡æ¯å¸®åŠ©å¿«é€Ÿå®šä½é—®é¢˜

### 2. ç•Œé¢ç¾è§‚å®ç”¨
- **å¸ƒå±€åˆç†**: UIå…ƒç´ ä¸é‡å ï¼Œä¿¡æ¯æ¸…æ™°å¯è§
- **è§†è§‰å¹³è¡¡**: å·¦å³é¢æ¿å¯¹ç§°ï¼Œæ•´ä½“åè°ƒ
- **ç©ºé—´åˆ©ç”¨**: æ›´å®½çš„é¢æ¿æä¾›æ›´å¥½çš„ä¿¡æ¯å±•ç¤º

### 3. æ“ä½œä¾¿åˆ©
- **ä¿¡æ¯å¯è§**: é‡è¦ä¿¡æ¯ä¸è¢«é®æŒ¡ï¼Œéšæ—¶å¯æŸ¥çœ‹
- **å±‚æ¬¡æ¸…æ™°**: UIå…ƒç´ åˆ†å±‚åˆç†ï¼Œä¸ä¼šæ··ä¹±
- **å“åº”åŠæ—¶**: æŒ‰é’®å’Œäº¤äº’å…ƒç´ å“åº”æ­£å¸¸

## æ€»ç»“

æœ¬æ¬¡ä¿®å¤æˆåŠŸè§£å†³äº†å…³å¡è¿›åº¦çš„æ ¸å¿ƒé—®é¢˜å’ŒUIå¸ƒå±€çš„è§†è§‰é—®é¢˜ï¼š

1. **åŠŸèƒ½å¯é æ€§**: é€šè¿‡æ”¹è¿›çŠ¶æ€ç®¡ç†ï¼Œç¡®ä¿å…³å¡è¿›åº¦ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
2. **è§†è§‰åè°ƒæ€§**: é€šè¿‡è°ƒæ•´å¸ƒå±€å’Œå°ºå¯¸ï¼Œæå‡äº†ç•Œé¢çš„ç¾è§‚åº¦å’Œå®ç”¨æ€§
3. **ç”¨æˆ·ä½“éªŒ**: æ¶ˆé™¤äº†å½±å“æ¸¸æˆæµç¨‹çš„éšœç¢ï¼Œæä¾›äº†æ›´æµç•…çš„æ¸¸æˆä½“éªŒ

è¿™äº›æ”¹è¿›ä¸ä»…è§£å†³äº†å½“å‰çš„é—®é¢˜ï¼Œè¿˜ä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å’ŒUIä¼˜åŒ–å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚æ•´ä¸ªä¿®å¤è¿‡ç¨‹ä¿æŒäº†ä»£ç çš„æ•´æ´æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œç¡®ä¿äº†æ¸¸æˆçš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒçš„æŒç»­æ”¹å–„ã€‚

---
**ä¿®å¤çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡  
**ç”¨æˆ·åé¦ˆ**: âœ… å·²è§£å†³  
**å®Œæˆæ—¶é—´**: 2026å¹´1æœˆ17æ—¥