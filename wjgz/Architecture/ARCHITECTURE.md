# 万剑归宗 - 架构设计文档

## 🏗️ 整体架构

本项目采用 **Clean Architecture + MVVM** 设计模式，确保代码的可维护性、可测试性和可扩展性。

### 架构分层

```
┌─────────────────────────────────────────────────────────────┐
│                    Presentation Layer                        │
│  • ViewModels (游戏状态管理)                                 │
│  • Views (UI组件)                                            │
│  • Coordinators (导航管理)                                   │
├─────────────────────────────────────────────────────────────┤
│                    Application Layer                         │
│  • Use Cases (业务用例)                                      │
│  • Services (应用服务)                                       │
│  • DTOs (数据传输对象)                                       │
├─────────────────────────────────────────────────────────────┤
│                    Domain Layer                              │
│  • Entities (核心实体)                                       │
│  • Value Objects (值对象)                                    │
│  • Domain Services (领域服务)                                │
│  • Repositories (仓储接口)                                   │
├─────────────────────────────────────────────────────────────┤
│                    Infrastructure Layer                      │
│  • Repositories (仓储实现)                                   │
│  • External Services (外部服务)                              │
│  • Configuration (配置管理)                                  │
│  • Dependency Injection (依赖注入)                           │
└─────────────────────────────────────────────────────────────┘
```

### 核心设计原则

1. **单一职责原则** - 每个类只负责一个功能
2. **依赖倒置原则** - 高层模块不依赖低层模块
3. **开闭原则** - 对扩展开放，对修改关闭
4. **接口隔离原则** - 使用小而专一的接口
5. **里氏替换原则** - 子类可以替换父类

### 模块划分

- **GameCore** - 游戏核心逻辑
- **AudioSystem** - 音效系统
- **EffectsSystem** - 特效系统
- **LevelSystem** - 关卡系统
- **UISystem** - 用户界面系统
- **ConfigurationSystem** - 配置系统

## 🎯 重构目标

1. 将 GameScene.swift (2020行) 拆分为多个专职模块
2. 实现依赖注入容器
3. 添加完整的单元测试覆盖
4. 优化性能和内存管理
5. 提升代码可读性和维护性